!function($,e,i){function a(e,i){e=e.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),n=a.exec(i);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function n(e){var i=["doing_wp_cron","envira_social_gallery_id","envira_social_gallery_item_id","rand","envira","envira_album","album_id"];return e=o(e,"doing_wp_cron"),e=o(e,"envira_social_gallery_id"),e=o(e,"envira_social_gallery_item_id"),e=o(e,"rand"),e=o(e,"envira"),e=o(e,"envira_album"),e=o(e,"album_id")}function o(e,i){var a=e.split("?");if(a.length>=2){for(var n=encodeURIComponent(i)+"=",o=a[1].split(/[&;]/g),l=o.length;l-- >0;)-1!==o[l].lastIndexOf(n,0)&&o.splice(l,1);return e=a[0]+(o.length>0?"?"+o.join("&"):"")}return e}var l=!1,t=null,r=null,s=null;$(function(){$(i).on("envirabox_api_before_show",function(){t=null,r=null,s=null,(void 0===l||l===!1)&&(l=$(".envirabox-inner div.envira-social-buttons-exterior"))}),$(i).on("envirabox_api_after_show",function(e,i,a,n){t=i,r=a,s=n,$(".envirabox-position-overlay").css("z-index","1"),$(".envirabox-position-overlay").css("position","absolute"),$(".envirabox-position-overlay").css("visibility","visible"),$(".envirabox-position-overlay").css("opacity","1"),envira_social.debug&&console.log(s),void 0!==l&&l!==!1&&l.prependTo(s.$content).addClass("social-active")}),$(i).on("click",".envirabox-inner .envira-social-buttons a",function(i){if(void 0!==t.data.album_id)var o="album",l=$.trim(t.id),r=3187;else var o="gallery",r=$.trim(t.id),l=!1;var c=e.location.hash,d=$(this).attr("href"),g=$(this).parent().data("width"),_=$(this).parent().data("height"),p=$(this).parent().data("network"),v=$(this).parent().data("deeplinking"),u="";if(envira_pagination_page=!1,envira_lb_image=$("img.envirabox-image").attr("src"),envira_gallery_item_id=!1,envira_gallery_item_title=!1,envira_gallery_item_caption=!1,envira_gallery_item_src=!1,envira_gallery_item_full_size=!1,link_source=$(".envirabox-wrap"),rand=Math.floor(1e4*Math.random()+1),envira_permalink=a("envira",e.location.href),"gallery"==o)if(envira_gallery_item_id=s.enviraItemId,envira_gallery_item_title=void 0!==s.enviraCaption&&""!=s.enviraCaption?s.enviraCaption:"",envira_gallery_item_caption=void 0!==s.caption&&""!=s.caption?s.caption:"",envira_gallery_item_src=s.src,"iframe"==s.type||void 0!==s.subtype&&"facebook"==s.subtype)envira_gallery_item_full_size=void 0!==s.videoPlaceholder&&""!=s.videoPlaceholder?s.videoPlaceholder:s.thumb;else{var m=t.data.social_email_image_size;""!==m&&void 0!==m?(envira_gallery_item_full_size=s.link,envira_gallery_item_id in t.images&&void 0!==t.images[envira_gallery_item_id][m]&&(envira_gallery_item_full_size=t.images[envira_gallery_item_id][m])):envira_gallery_item_full_size=s.link}else{if("album"!=o)return;envira_gallery_item_id=s.id,envira_gallery_item_title=s.title,envira_gallery_item_caption=s.caption,envira_gallery_item_src=s.src;var m=t.data.social_email_image_size;""!==m&&void 0!==m?(envira_gallery_item_full_size=s.link,m in s&&(envira_gallery_item_full_size=s[m])):envira_gallery_item_full_size=s.link}$(".envira-pagination").length>0&&(envira_pagination_page=a("page",$(this).attr("href")),envira_pagination_page||(envira_pagination_page=$(this).closest(".envira-gallery-wrap").find(".envira-pagination").data("page"),envira_pagination_page||(envira_pagination_page=$("img.envirabox-image").data("pagination-page")))),void 0!==envira_pagination_page&&envira_pagination_page!==!1&&(u=envira_pagination_page+"/"),"undefined"!=typeof envira_permalink&&null!==envira_permalink?envira_permalink="envira="+envira_permalink:envira_permalink="",("undefined"==typeof envira_gallery_item_full_size||null===envira_gallery_item_full_size)&&(envira_gallery_item_full_size=envira_gallery_item_src),envira_social.debug&&(console.log("detected gallery_id (lightbox):"+r),console.log("detected gallery_item_id (lightbox):"+envira_gallery_item_id),console.log("detected hash:"+c),console.log("detected envira_permalink:"+envira_permalink)),"undefined"==typeof y&&(w=""),"undefined"==typeof w&&(w="");var f=c.length>0?e.location.href.split("#")[0]:e.location.href.split("?")[0];switch(envira_social.debug&&console.log("base_link (lightbox):"+f),f=n(f),envira_social.debug&&console.log("base_link cleaned (lightbox):"+f),envira_permalink&&(envira_permalink="&"+envira_permalink),link=c.length>0?f+"?envira_album_id="+l+"&envira_social_gallery_id="+r+"&envira_social_gallery_item_id="+envira_gallery_item_id+"&rand="+rand+envira_permalink+c:f+u+"?envira_album_id="+l+"&envira_social_gallery_id="+r+"&envira_social_gallery_item_id="+envira_gallery_item_id+"&rand="+rand+envira_permalink,p){case"facebook":var h="",b="",y="",k="";"undefined"!=typeof $(this).attr("data-envira-social-facebook-text")&&(b=decodeURIComponent($(this).data("envira-social-facebook-text")),b=b.replace(new RegExp("\\+","g")," "),""==$.trim(b)&&(b=" "),envira_social.debug&&(console.log("updating facebook_text"),console.log(b))),"undefined"!=typeof $(this).attr("data-envira-facebook-quote")&&(h=decodeURIComponent($(this).data("envira-facebook-quote")),h=h.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating quote"),console.log(h))),"undefined"!=typeof $(this).attr("data-envira-title")&&(y=decodeURIComponent($(this).data("envira-title")),y=y.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating title"),console.log(y))),"undefined"!=typeof $(this).attr("data-facebook-tags-manual")?(k=decodeURIComponent($(this).data("facebook-tags-manual")),k=k.replace(new RegExp("\\+","g")," "),k=k.replace(/-/g,""),envira_social.debug&&(console.log("updating tags"),console.log(y))):envira_social.debug&&(console.log("updating tags - missing"),console.log($(".envirabox-wrap").find("img.envirabox-image").data("envira-facebook-tags-manual"))),d="https://www.facebook.com/dialog/feed?app_id="+envira_social.facebook_app_id+"&display=popup&link="+link+"&picture="+envira_gallery_item_src+"&name="+y+"&caption="+w+"&description="+b+"&redirect_uri="+link+"#envira_social_sharing_close";break;case"twitter":var x="";"undefined"!=typeof $(this).attr("data-envira-social-twitter-text")&&(x=decodeURIComponent($(this).data("envira-social-twitter-text")),x=x.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating twitter_text"),console.log(x))),envira_social.debug&&(console.log("updating twitter_text"),console.log(x),console.log("caption"));var w=w.replace(/"/g,"&quote;");d="https://twitter.com/intent/tweet?text="+encodeURIComponent($.trim($.trim(w)+" "+$.trim(x)))+"&url="+encodeURIComponent(link),envira_social.debug&&(console.log("twitter url (lightbox):"),console.log(d));break;case"google":d="https://plus.google.com/share?url="+encodeURIComponent(link),envira_social.debug&&(console.log("google url (lightbox):"),console.log(d));break;case"pinterest":d="http://pinterest.com/pin/create/button/?url="+link+"&media="+envira_gallery_item_full_size+"&description="+w,envira_social.debug&&(console.log("pinterest url (lightbox):"),console.log(d));break;case"whatsapp":d="whatsapp://send?text="+link,envira_social.debug&&(console.log("whatsapp url (lightbox):"),console.log(d));break;case"email":if(envira_social.debug&&(console.log("envira_permalink (lightboxx):"),console.log(envira_permalink),console.log(envira_permalink.length)),"undefined"!=typeof envira_permalink&&null!==envira_permalink&&envira_permalink.length>0)var R=c.length>0?f+"?"+envira_permalink+c:f+u+"?"+envira_permalink;else var R=c.length>0?f+c:f+u;""==w&&(w="&nbsp;"),d="mailto:?subject="+encodeURIComponent(w)+"&body=Photo:"+envira_gallery_item_full_size+"&URL:"+R,envira_social.debug&&(console.log("email url (lightbox):"),console.log(envira_gallery_item_full_size),console.log(d),console.log(link))}if("pinterest"===p){"undefined"==typeof description&&"undefined"!=typeof w?description=w:"undefined"==typeof description&&(description="");var C=null;void 0!==C&&"pin-all"==C?PinUtils.pinAny({media:envira_gallery_item_full_size,description:description,url:link}):PinUtils.pinOne({media:envira_gallery_item_full_size,description:description,url:link})}else if("facebook"===p){if(c.length>0)var U=link;else if(link.length>0)var U=link;else var U=e.location.href;envira_social.debug&&(console.log("sending facebook link:"),console.log(U)),U=$.trim(U),U=U.replace(/(\r\n|\n|\r)/gm,""),"undefined"!=typeof FB?FB.ui({method:"share",display:"popup",href:U,title:y,description:b,caption:w,picture:envira_gallery_item_full_size,hashtag:k,quote:h}):e.open("https://www.facebook.com/sharer/sharer.php?u="+U,"_blank"),clicked=!0}else if("email"===p)e.location=d;else if("whatsapp"===p)alert("whatsapp"),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?e.location.href=d:alert("you are not on mobile device.");else{var I=e.open(d,"Share","width="+g+",height="+_);envira_social.debug&&(console.log("url:"),console.log(d),console.log(encodeURIComponent(d)))}return envira_social.debug&&console.log("link (lightbox):"+link),envira_social.debug&&(console.log("envira_gallery_item_id"),console.log(envira_gallery_item_id),console.log("full_size_image url (lightbox):"),console.log(envira_gallery_item_full_size),console.log("src"),console.log(envira_gallery_item_src),console.log("title"),console.log(envira_gallery_item_title),console.log("caption"),console.log(envira_gallery_item_caption),console.log("envira_permalink"),console.log(envira_permalink),console.log("----")),!1}),$(i).on("click",".envira-gallery-wrap .envira-social-buttons a",function(i){i.preventDefault();var n=e.location.hash,o=$(this).attr("href"),l=$(this).parent().data("width"),t=$(this).parent().data("height"),r=$(this).parent().data("network"),s=$(this).parent().data("deeplinking"),c="",d=!1;if($(".envira-pagination").length>0&&(d=a("page",$(this).attr("href")),d||(d=$(this).closest(".envira-gallery-wrap").find(".envira-pagination").data("page"),d||(d=$("img.envirabox-image").data("pagination-page")))),d)var c=d+"/";var g=$(this).data("envira-gallery-id"),_=$(this).data("envira-item-id"),p=Math.floor(1e4*Math.random()+1),v=a("envira",e.location.href);if(envira_social.debug&&(console.log("detected gallery_id (gallery): "+g),console.log("detected gallery_item_id (gallery): "+_)),"undefined"!=typeof $(this).attr("data-envira-album-id")){var u=$(this).data("envira-album-id");envira_social.debug&&(console.log("album_id is currently:"),console.log(u))}else var u=!1;switch(v="undefined"!=typeof v&&null!==v?"envira="+v:"",envira_social.debug&&console.log("envira_permalink:"+v),r){case"facebook":var m="",f="",h="",b="",y="",k="";if("undefined"!=typeof $(this).attr("data-envira-social-facebook-text")&&(f=decodeURIComponent($(this).data("envira-social-facebook-text")),f=f.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating facebook_text:"),console.log(f))),"undefined"!=typeof $(this).attr("data-envira-caption")){var y=decodeURIComponent($(this).data("envira-facebook-caption"));y=y.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating caption:"),console.log(y))}"undefined"!=typeof $(this).attr("data-envira-facebook-quote")&&(m=decodeURIComponent($(this).data("envira-facebook-quote")),m=m.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating quote:"),console.log(m))),"undefined"!=typeof $(this).attr("data-envira-title")&&(h=decodeURIComponent($(this).data("envira-title")),h=h.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating title:"),console.log(h))),"undefined"!=typeof $(this).attr("data-envira-facebook-tags")&&(b=decodeURIComponent($(this).data("envira-facebook-tags")),b=b.replace(new RegExp("\\+","g")," "),b=b.replace(/-/g,""),envira_social.debug&&(console.log("updating tags:"),console.log(b))),"undefined"!=typeof $(this).attr("data-envira-social-picture")&&(k=decodeURIComponent($(this).data("envira-social-picture")),k=k.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating image:"),console.log(k)));var x=n.length>0?e.location.href.split("#")[0]+encodeURIComponent(n)+"&envira_album_id="+u+"&envira_social_gallery_id="+g+"&envira_social_gallery_item_id="+_:e.location.href.split("?")[0]+c+"?envira_album_id="+u+"&envira_social_gallery_id="+g+"&envira_social_gallery_item_id="+_+"&rand="+p+"&"+v;break;case"pinterest":var w="",R="pin-one",k="";"undefined"!=typeof $(this).attr("data-envira-social-pinterest-description")&&(w=decodeURIComponent($(this).data("envira-social-pinterest-description")),w=w.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating pinterest description"),console.log(w))),"undefined"!=typeof $(this).attr("data-envira-social-picture")&&(k=decodeURIComponent($(this).data("envira-social-picture")),k=k.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating pinterest image"),console.log(k))),"undefined"!=typeof $(this).attr("data-envira-pinterest-type")&&(R=decodeURIComponent($(this).data("envira-pinterest-type")),R=R.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating pinterest ptype"),console.log(R)));var x=n.length>0?e.location.href.split("#")[0]+encodeURIComponent(n)+"&envira_album_id="+u+"&envira_social_gallery_id="+g+"&envira_social_gallery_item_id="+_+"&"+v:e.location.href.split("?")[0]+"?envira_album_id="+u+"&envira_social_gallery_id="+g+"&envira_social_gallery_item_id="+_+"&rand="+p+"&"+v;envira_social.debug&&(console.log("pinterest link:"),console.log(k))}if("pinterest"===r)"undefined"==typeof w&&"undefined"!=typeof y?w=y:"undefined"==typeof w&&(w=""),void 0!==R&&"pin-all"==R?PinUtils.pinAny({media:k,description:w,url:x}):PinUtils.pinOne({media:k,description:w,url:x});else if("facebook"===r){if(n.length>0)var C=x;else if(x.length>0)var C=x;else var C=e.location.href;envira_social.debug&&(console.log("sending facebook link:"),console.log(C)),FB.ui({method:"share",display:"popup",href:C,title:h,description:f,caption:y,picture:k,hashtag:b,quote:m})}else if("email"===r)e.location=o;else{var U=e.open(o,"Share","width="+l+",height="+t);envira_social.debug&&(console.log("url:"),console.log(o),console.log(encodeURIComponent(o)))}return!1}),$("div.envira-gallery-item-inner").each(function(){0===$(this).find(".envira-social-buttons .envira-social-network").length&&$(this).find("div.envira-social-buttons").remove()}),location.href.search("envira_social_sharing_close")>-1&&e.close()}),i.getElementsByClassName("button-facebook").onclick=function(){FB.ui({method:"share",display:"popup",href:"https://developers.facebook.com/docs/"},function(e){})}}(jQuery,window,document);